<?xml version="1.0" encoding="UTF-8"?>
<!-- Generated by Apache ServiceMix Archetype -->
<beans xmlns:eip="http://servicemix.apache.org/eip/1.0"
    xmlns:replaceMe="http://servicemix.apache.org/replaceMe" xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://servicemix.apache.org/eip/1.0 http://servicemix.apache.org/schema/servicemix-eip-2013.01.xsd
       http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd">

    <!--
        WARNING: The ServiceMix EIP component is deprecated. Please use the ServiceMix Camel component
                 to implement EIP.
                 
        The ServiceMix EIP component is a routing container where different routing patterns can be
        deployed as service unit.
        The support patterns are:
            - Content-Based Router
            - Message Filter
            - Pipeline
            - Static Recipient List 
            - Static Routing Slip
            - Wire Tap
            - XPath Splitter
            - Aggregator
            - Content Enricher
            - Resequencer
            - AsyncBridge
    -->
    
    <!-- 
        The EIP configuration is defined directly in the xbean.
        
        Some EIP samples follow.
    -->

    <!-- BEGIN SNIPPET: static-recipient-list -->
    <eip:static-recipient-list service="replaceMe:serviceName"
        endpoint="static-recipient-list">
        <eip:recipients>
            <eip:exchange-target service="replaceMe:serviceName"
                endpoint="wire-tap" />
            <eip:exchange-target service="replaceMe:serviceName"
                endpoint="aggregator-splitter" />
        </eip:recipients>
    </eip:static-recipient-list>
    <!-- END SNIPPET: static-recipient-list -->

    <!-- BEGIN SNIPPET: aggregator-splitter -->
    <eip:xpath-splitter service="replaceMe:serviceName"
        endpoint="aggregator-splitter" xpath="/*/*" namespaceContext="#nsContext">
        <eip:target>
            <eip:exchange-target service="replaceMe:serviceName" endpoint="aggregator" />
        </eip:target>
    </eip:xpath-splitter>
    <!-- END SNIPPET: aggregator-splitter -->

    <!-- BEGIN SNIPPET: aggregator -->
    <eip:split-aggregator service="replaceMe:serviceName"
        endpoint="aggregator">
        <eip:target>
            <eip:exchange-target service="replaceMe:trace5" />
        </eip:target>
    </eip:split-aggregator>
    <!-- END SNIPPET: aggregator -->

    <!-- BEGIN SNIPPET: wire-tap -->
    <eip:wire-tap service="replaceMe:serviceName" endpoint="wire-tap">
        <eip:target>
            <eip:exchange-target service="replaceMe:xpath-splitter" />
        </eip:target>
        <eip:inListener>
            <eip:exchange-target service="replaceMe:trace" />
        </eip:inListener>
    </eip:wire-tap>
    <!-- END SNIPPET: wire-tap -->

    <!-- BEGIN SNIPPET: xpath-splitter -->
    <eip:xpath-splitter service="replaceMe:serviceName"
        endpoint="xpath-splitter" xpath="/*/*" namespaceContext="#nsContext">
        <eip:target>
            <eip:exchange-target
                uri="service:http://servicemix.apache.org/replaceMe/router" />
        </eip:target>
    </eip:xpath-splitter>
    <!-- END SNIPPET: xpath-splitter -->

    <!-- BEGIN SNIPPET: router -->
    <eip:content-based-router service="replaceMe:serviceName"
        endpoint="router">
        <eip:rules>
            <eip:routing-rule>
                <eip:predicate>
                    <eip:xpath-predicate xpath="count(/replaceMe:echo) = 1"
                        namespaceContext="#nsContext" />
                </eip:predicate>
                <eip:target>
                    <eip:exchange-target
                        uri="endpoint:http://servicemix.apache.org/replaceMe/pipeline/endpoint" />
                </eip:target>
            </eip:routing-rule>
            <eip:routing-rule>
                <!-- there is no predicate, so this is the default destination -->
                <eip:target>
                    <eip:exchange-target service="replaceMe:recipients" />
                </eip:target>
            </eip:routing-rule>
        </eip:rules>
    </eip:content-based-router>
    <!-- END SNIPPET: router -->

    <!-- BEGIN SNIPPET: pipeline -->
    <eip:pipeline service="replaceMe:serviceName" endpoint="pipeline">
        <eip:transformer>
            <eip:exchange-target service="replaceMe:serviceName" endpoint="routing-slip" />
        </eip:transformer>
        <eip:target>
            <eip:exchange-target service="replaceMe:serviceName" endpoint="trace"/>
        </eip:target>
    </eip:pipeline>
    <!-- END SNIPPET: pipeline -->

    <!-- BEGIN SNIPPET: recipients -->
    <eip:static-recipient-list service="replaceMe:serviceName"
        endpoint="recipients">
        <eip:recipients>
            <eip:exchange-target service="replaceMe:serviceName" endpoint="message-filter" />
            <eip:exchange-target service="replaceMe:serviceName" endpoint="trace" />
        </eip:recipients>
    </eip:static-recipient-list>
    <!-- END SNIPPET: recipients -->

    <!-- BEGIN SNIPPET: routing-slip -->
    <eip:static-routing-slip service="replaceMe:serviceName"
        endpoint="routing-slip">
        <eip:targets>
            <eip:exchange-target service="replaceMe:serviceName" endpoint="echo" />
            <eip:exchange-target service="replaceMe:serviceName" endpoint="echo" />
        </eip:targets>
    </eip:static-routing-slip>

    <!-- BEGIN SNIPPET: message-filter -->
    <eip:message-filter service="replaceMe:serviceName"
        endpoint="message-filter">
        <eip:target>
            <eip:exchange-target service="replaceMe:serviceName" endpoint="trace" />
        </eip:target>
        <eip:filter>
            <eip:xpath-predicate xpath="count(/replaceMe:world) = 1"
                namespaceContext="#nsContext" />
        </eip:filter>
    </eip:message-filter>
    <!-- END SNIPPET: message-filter -->

    <eip:namespace-context id="nsContext">
        <eip:namespaces>
            <eip:namespace prefix="replaceMe">http://servicemix.apache.org/replaceMe
            </eip:namespace>
        </eip:namespaces>
    </eip:namespace-context>

    <!-- BEGIN SNIPPET: resequencer -->
    <eip:resequencer service="replaceMe:serviceName"
        endpoint="resequencer" capacity="100" timeout="2000">
        <eip:target>
            <eip:exchange-target service="replaceMe:serviceName" endpoint="trace" />
        </eip:target>
    </eip:resequencer>
    <!-- END SNIPPET: resequencer -->

</beans>
